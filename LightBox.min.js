!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Tobii=t()}(this,function(){"use strict";return function(e){var t={},r=window,n=0,i=null,a=null,o=null,d=null,l=null,s={},u=!1,c=!1,p=!1,f=null,b=null,h=null,m=null,g=null,v=!1,y=!1,A=[],w=[],E=0,L={gallery:[],slider:null,sliderElements:[],elementsLength:0,currentIndex:0,x:0},x={},C=null,S=null,_={image:{checkSupport:function(e){return!e.hasAttribute("data-type")&&e.href.match(/\.(png|jpe?g|tiff|tif|gif|bmp|webp|svg|ico)(\?.*)?$/i)},init:function(e,r){var i=document.createElement("figure"),a=document.createElement("figcaption"),o=document.createElement("img"),d=e.querySelector("img"),l=document.createElement("div");i.style.opacity="0",d&&(o.alt=d.alt||""),o.setAttribute("src",""),o.setAttribute("data-src",e.href),i.appendChild(o),t.captions&&("self"===t.captionsSelector&&e.getAttribute(t.captionAttribute)?a.textContent=e.getAttribute(t.captionAttribute):"img"===t.captionsSelector&&d&&d.getAttribute(t.captionAttribute)&&(a.textContent=d.getAttribute(t.captionAttribute)),a.textContent&&(a.id="tobii-figcaption-"+n,i.appendChild(a),o.setAttribute("aria-labelledby",a.id),++n)),r.appendChild(i),l.className="tobii-loader",l.setAttribute("role","progressbar"),l.setAttribute("aria-label",t.loadingIndicatorLabel),r.appendChild(l),r.setAttribute("data-type","image")},onPreload:function(e){_.image.onLoad(e)},onLoad:function(e){var t=e.querySelector("img");if(t.hasAttribute("data-src")){var r=e.querySelector("figure"),n=e.querySelector(".tobii-loader");t.onload=function(){e.removeChild(n),r.style.opacity="1"},t.setAttribute("src",t.getAttribute("data-src")),t.removeAttribute("data-src")}},onLeave:function(e){},onCleanup:function(e){}},html:{checkSupport:function(e){return ae(e,"html")},init:function(e,t){var r=e.hasAttribute("href")?e.getAttribute("href"):e.getAttribute("data-target"),n=document.querySelector(r);if(!n)throw new Error("Ups, I can't find the target "+r+".");t.appendChild(n),t.setAttribute("data-type","html")},onPreload:function(e){},onLoad:function(e){var r=e.querySelector("video");r&&(r.hasAttribute("data-time")&&r.readyState>0&&(r.currentTime=r.getAttribute("data-time")),t.autoplayVideo&&r.play())},onLeave:function(e){var t=e.querySelector("video");t&&(t.paused||t.pause(),t.readyState>0&&t.setAttribute("data-time",t.currentTime))},onCleanup:function(e){var t=e.querySelector("video");if(t&&t.readyState>0&&t.readyState<3&&t.duration!==t.currentTime){var r=t.cloneNode(!0);oe(t),t.load(),t.parentNode.removeChild(t),e.appendChild(r)}}},iframe:{checkSupport:function(e){return ae(e,"iframe")},init:function(e,t){var r=document.createElement("iframe"),n=e.hasAttribute("href")?e.getAttribute("href"):e.getAttribute("data-target");r.setAttribute("frameborder","0"),r.setAttribute("src",""),r.setAttribute("data-src",n),e.getAttribute("data-width")&&(r.style.maxWidth=e.getAttribute("data-width")+"px"),e.getAttribute("data-height")&&(r.style.maxHeight=e.getAttribute("data-height")+"px"),t.appendChild(r),t.setAttribute("data-type","iframe")},onPreload:function(e){},onLoad:function(e){var t=e.querySelector("iframe");t.setAttribute("src",t.getAttribute("data-src"))},onLeave:function(e){},onCleanup:function(e){}},youtube:{checkSupport:function(e){return ae(e,"youtube")},init:function(e,t){var r=document.createElement("div");t.appendChild(r),w[E]=new window.YT.Player(r,{host:"https://www.youtube-nocookie.com",height:e.getAttribute("data-height")||"360",width:e.getAttribute("data-width")||"640",videoId:e.getAttribute("data-id"),playerVars:{controls:e.getAttribute("data-controls")||1,rel:0,playsinline:1}}),t.setAttribute("data-player",E),t.setAttribute("data-type","youtube"),E++},onPreload:function(e){},onLoad:function(e){t.autoplayVideo&&w[e.getAttribute("data-player")].playVideo()},onLeave:function(e){1===w[e.getAttribute("data-player")].getPlayerState()&&w[e.getAttribute("data-player")].pauseVideo()},onCleanup:function(e){1===w[e.getAttribute("data-player")].getPlayerState()&&w[e.getAttribute("data-player")].pauseVideo()}}};Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),r=t.length,n=new Array(r);r--;)n[r]=[t[r],e[t[r]]];return n});var I=function(e,t){if(null===document.querySelector('[data-type="youtube"]')||y)N(e,t);else{if(null===document.getElementById("iframe_api")){var r=document.createElement("script"),n=document.getElementsByTagName("script")[0];r.id="iframe_api",r.src="https://www.youtube.com/iframe_api",n.parentNode.insertBefore(r,n)}-1===A.indexOf(e)&&A.push(e),window.onYouTubePlayerAPIReady=function(){Array.prototype.forEach.call(A,function(e){N(e,t)}),y=!0}}},T=function(e){return e.hasAttribute("data-group")?e.getAttribute("data-group"):"default"},N=function(e,r){var n;if(C=T(e),Object.prototype.hasOwnProperty.call(x,C)||(x[C]=(n=L,JSON.parse(JSON.stringify(n))),P()),-1!==x[C].gallery.indexOf(e))throw new Error("Ups, element already added to the lightbox.");if(x[C].gallery.push(e),x[C].elementsLength++,t.zoom&&e.querySelector("img")){var i=document.createElement("div");i.className="tobii-zoom__icon",i.innerHTML=t.zoomText,e.classList.add("tobii-zoom"),e.appendChild(i)}e.addEventListener("click",J),q(e),se()&&C===S&&(de(),le()),r&&r.call(this)},O=function(e,r){var n=T(e);if(-1===x[n].gallery.indexOf(e));else{var i=x[n].gallery.indexOf(e),a=x[n].sliderElements[i];if(x[n].elementsLength--,t.zoom&&e.querySelector(".tobii-zoom__icon")){var o=e.querySelector(".tobii-zoom__icon");o.parentNode.classList.remove("tobii-zoom"),o.parentNode.removeChild(o)}e.removeEventListener("click",J),a.parentNode.removeChild(a),se()&&n===S&&(de(),le()),r&&r.call(this)}},k=function(){(i=document.createElement("div")).setAttribute("role","dialog"),i.setAttribute("aria-hidden","true"),i.className="tobii",(a=document.createElement("button")).className="tobii__prev",a.setAttribute("type","button"),a.setAttribute("aria-label",t.navLabel[0]),a.innerHTML=t.navText[0],i.appendChild(a),(o=document.createElement("button")).className="tobii__next",o.setAttribute("type","button"),o.setAttribute("aria-label",t.navLabel[1]),o.innerHTML=t.navText[1],i.appendChild(o),(d=document.createElement("button")).className="tobii__close",d.setAttribute("type","button"),d.setAttribute("aria-label",t.closeLabel),d.innerHTML=t.closeText,i.appendChild(d),(l=document.createElement("div")).className="tobii__counter",i.appendChild(l),document.body.appendChild(i)},P=function(){x[C].slider=document.createElement("div"),x[C].slider.className="tobii__slider",i.appendChild(x[C].slider)},q=function(e){for(var t in _)if(Object.prototype.hasOwnProperty.call(_,t)&&_[t].checkSupport(e)){var r=document.createElement("div"),n=document.createElement("div");r.className="tobii__slider-slide",r.style.position="absolute",r.style.left=100*x[C].x+"%",_[t].init(e,n),r.appendChild(n),x[C].slider.appendChild(r),x[C].sliderElements.push(r),++x[C].x;break}},X=function(e,r){if(S=null!==S?S:C,se()||e||(e=0),se()){if(!e)throw new Error("Ups, Tobii is aleady open.");if(e===x[S].currentIndex)throw new Error("Ups, slide "+e+" is already selected.")}if(-1===e||e>=x[S].elementsLength)throw new Error("Ups, I can't find slide "+e+".");t.hideScrollbar&&(document.documentElement.classList.add("tobii-is-open"),document.body.classList.add("tobii-is-open")),de(),t.close||(d.disabled=!1,d.setAttribute("aria-hidden","true")),f=document.activeElement,x[S].currentIndex=e,B(),ne(),z(x[S].currentIndex),i.setAttribute("aria-hidden","false"),le(),Y(x[S].currentIndex+1),Y(x[S].currentIndex-1),setTimeout(function(){x[S].slider.classList.add("tobii__slider--animate")},1e3),r&&r.call(this)},M=function(e){if(!se())throw new Error("Tobii is already closed.");t.hideScrollbar&&(document.documentElement.classList.remove("tobii-is-open"),document.body.classList.remove("tobii-is-open")),ie(),f.focus();var r=x[S].sliderElements[x[S].currentIndex].querySelector("[data-type]"),n=r.getAttribute("data-type");_[n].onLeave(r),_[n].onCleanup(r),i.setAttribute("aria-hidden","true"),x[S].currentIndex=0,x[S].slider.classList.remove("tobii__slider--animate"),e&&e.call(this)},Y=function(e){if(void 0!==x[S].sliderElements[e]){var t=x[S].sliderElements[e].querySelector("[data-type]"),r=t.getAttribute("data-type");_[r].onPreload(t)}},z=function(e){if(void 0!==x[S].sliderElements[e]){var t=x[S].sliderElements[e].querySelector("[data-type]"),r=t.getAttribute("data-type");_[r].onLoad(t)}},j=function(e){x[S].currentIndex>0&&(U(x[S].currentIndex),z(--x[S].currentIndex),le("left"),V(x[S].currentIndex+1),Y(x[S].currentIndex-1),e&&e.call(this))},D=function(e){x[S].currentIndex<x[S].elementsLength-1&&(U(x[S].currentIndex),z(++x[S].currentIndex),le("right"),V(x[S].currentIndex-1),Y(x[S].currentIndex+1),e&&e.call(this))},U=function(e){if(void 0!==x[S].sliderElements[e]){var t=x[S].sliderElements[e].querySelector("[data-type]"),r=t.getAttribute("data-type");_[r].onLeave(t)}},V=function(e){if(void 0!==x[S].sliderElements[e]){var t=x[S].sliderElements[e].querySelector("[data-type]"),r=t.getAttribute("data-type");_[r].onCleanup(t)}},H=function(){m=-x[S=null!==S?S:C].currentIndex*i.offsetWidth,x[S].slider.style.transform="translate3d("+m+"px, 0, 0)",g=m},B=function(){s={startX:0,endX:0,startY:0,endY:0}},R=function(){var e=s.endX-s.startX,r=s.endY-s.startY,n=Math.abs(e),i=Math.abs(r);e>0&&n>t.threshold&&x[S].currentIndex>0?j():e<0&&n>t.threshold&&x[S].currentIndex!==x[S].elementsLength-1?D():r<0&&i>t.threshold&&t.swipeClose?M():H()},G=function(){v||(v=!0,r.requestAnimationFrame(function(){H(),v=!1}))},J=function(e){e.preventDefault(),S=T(this),X(x[S].gallery.indexOf(this))},W=function(e){e.target===a?j():e.target===o?D():(e.target===d||"tobii__slider-slide"===e.target.className&&t.docClose)&&M(),e.stopPropagation()},F=function(e){9===e.keyCode||"Tab"===e.code?e.shiftKey?document.activeElement===b&&(h.focus(),e.preventDefault()):document.activeElement===h&&(b.focus(),e.preventDefault()):27===e.keyCode||"Escape"===e.code?(e.preventDefault(),M()):37===e.keyCode||"ArrowLeft"===e.code?(e.preventDefault(),j()):39!==e.keyCode&&"ArrowRight"!==e.code||(e.preventDefault(),D())},K=function(e){ce(e.target)||(e.stopPropagation(),p=!0,s.startX=e.touches[0].pageX,s.startY=e.touches[0].pageY,x[S].slider.classList.add("tobii__slider--is-dragging"))},$=function(e){e.stopPropagation(),p&&(e.preventDefault(),s.endX=e.touches[0].pageX,s.endY=e.touches[0].pageY,re())},Q=function(e){e.stopPropagation(),p=!1,x[S].slider.classList.remove("tobii__slider--is-dragging"),s.endX&&(u=!1,c=!1,R()),B()},Z=function(e){ce(e.target)||(e.preventDefault(),e.stopPropagation(),p=!0,s.startX=e.pageX,s.startY=e.pageY,x[S].slider.classList.add("tobii__slider--is-dragging"))},ee=function(e){e.preventDefault(),p&&(s.endX=e.pageX,s.endY=e.pageY,re())},te=function(e){e.stopPropagation(),p=!1,x[S].slider.classList.remove("tobii__slider--is-dragging"),s.endX&&(u=!1,c=!1,R()),B()},re=function(){Math.abs(s.startX-s.endX)>0&&!c&&t.swipeClose?(x[S].slider.style.transform="translate3d("+(g-Math.round(s.startX-s.endX))+"px, 0, 0)",u=!0,c=!1):Math.abs(s.startY-s.endY)>0&&!u&&(x[S].slider.style.transform="translate3d("+g+"px, -"+Math.round(s.startY-s.endY)+"px, 0)",u=!1,c=!0)},ne=function(){t.keyboard&&r.addEventListener("keydown",F),r.addEventListener("resize",G),i.addEventListener("click",W),t.draggable&&(ue()&&(i.addEventListener("touchstart",K),i.addEventListener("touchmove",$),i.addEventListener("touchend",Q)),i.addEventListener("mousedown",Z),i.addEventListener("mouseup",te),i.addEventListener("mousemove",ee))},ie=function(){t.keyboard&&r.removeEventListener("keydown",F),r.removeEventListener("resize",G),i.removeEventListener("click",W),t.draggable&&(ue()&&(i.removeEventListener("touchstart",K),i.removeEventListener("touchmove",$),i.removeEventListener("touchend",Q)),i.removeEventListener("mousedown",Z),i.removeEventListener("mouseup",te),i.removeEventListener("mousemove",ee))},ae=function(e,t){return e.getAttribute("data-type")===t},oe=function(e){var t=e.querySelectorAll("src");t&&Array.prototype.forEach.call(t,function(e){e.setAttribute("src","")})},de=function(){t.draggable&&x[S].elementsLength>1&&!x[S].slider.classList.contains("tobii__slider--is-draggable")&&x[S].slider.classList.add("tobii__slider--is-draggable"),!t.nav||1===x[S].elementsLength||"auto"===t.nav&&ue()?(a.setAttribute("aria-hidden","true"),o.setAttribute("aria-hidden","true")):(a.setAttribute("aria-hidden","false"),o.setAttribute("aria-hidden","false")),t.counter&&1!==x[S].elementsLength?l.setAttribute("aria-hidden","false"):l.setAttribute("aria-hidden","true")},le=function(e){!function(){for(var e in x)Object.prototype.hasOwnProperty.call(x,e)&&(x[e].slider.style.display=S===e?"block":"none")}(),H(),l.textContent=x[S].currentIndex+1+"/"+x[S].elementsLength,function(e){var r;t.nav?(a.disabled=!1,o.disabled=!1,"left"===e?a.focus():o.focus(),1===x[S].elementsLength?(a.disabled=!0,o.disabled=!0,t.close&&d.focus()):(0===x[S].currentIndex&&(a.disabled=!0,o.focus()),x[S].currentIndex===x[S].elementsLength-1&&(o.disabled=!0,a.focus()))):t.close&&d.focus(),r=i.querySelectorAll(".tobii > button:not(:disabled)"),b=r[0],h=1===r.length?r[0]:r[r.length-1]}(e)},se=function(){return"false"===i.getAttribute("aria-hidden")},ue=function(){return"ontouchstart"in window},ce=function(e){return-1!==["TEXTAREA","OPTION","INPUT","SELECT"].indexOf(e.nodeName)||e===a||e===o||e===d||1===x[S].elementsLength};return function(e){t=function(e){var t={selector:".lightbox",captions:!0,captionsSelector:"img",captionAttribute:"alt",nav:"auto",navText:['<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M14 18l-6-6 6-6"/></svg>','<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M10 6l6 6-6 6"/></svg>'],navLabel:["Previous image","Next image"],close:!0,closeText:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M6 6l12 12M6 18L18 6"/></svg>',closeLabel:"Close lightbox",loadingIndicatorLabel:"Image loading",counter:!0,download:!1,downloadText:"",downloadLabel:"Download image",keyboard:!0,zoom:!0,zoomText:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M21 16v5h-5"/><path d="M8 21H3v-5"/><path d="M16 3h5v5"/><path d="M3 8V3h5"/></svg>',docClose:!0,swipeClose:!0,hideScrollbar:!0,draggable:!0,threshold:100,rtl:!1,loop:!1,autoplayVideo:!1};return e&&Object.keys(e).forEach(function(r){t[r]=e[r]}),t}(e),i||k();var r=document.querySelectorAll(t.selector);if(!r)throw new Error("Ups, I can't find the selector "+t.selector+".");Array.prototype.forEach.call(r,function(e){I(e)})}(e),{open:X,prev:j,next:D,close:M,add:I,remove:O,destroy:function(e){se()&&M();var t=Object.entries(x);Array.prototype.forEach.call(t,function(e){var t=e[1].gallery;Array.prototype.forEach.call(t,function(e){O(e)})}),i.parentNode.removeChild(i),x={},C=S=null,n=0,e&&e.call(this)},isOpen:se,currentSlide:function(){return x[S].currentIndex},selectGroup:function(e){if(se())throw new Error("Ups, I can't do this. Tobii is open.");if(e){if(e&&!Object.prototype.hasOwnProperty.call(x,e))throw new Error("Ups, I don't have a group called \""+e+'".');S=e}},currentGroup:function(){return null!==S?S:C}}}});
